1.索引是什么
索引是数据库系统中维护的一种数据结构，它的作用是用来加快数据库的查询。比如，我们可以对所有的key值建立一棵查找二叉树，每个结点指向value的地址。那么这棵二叉树就是索引。
索引的缺点是需要占据额外的空间，同时，在修改数据库，(插入，删除，修改)数据时，需要额外维护索引。

应该创建索引的列：经常需要搜索的列，经常需要排序的列，经常需要根据范围搜索的列。
不应该创建索引的列：在查询时不经常作为参考的列，数据值很少的列（比如性别，因为结果集数据仍然会很大，没有显著加快查询）

为什么索引的底层实现不用hash而使用B+ tree。
虽然hash查询的时候是O(1)的，但是如果出现范围查找那么hash就没用了，而众所周知B+ tree的叶子是有序的。

2.B树和B+树

常用在数据库底层文件系统中。
B树实际上是一棵多叉的平衡查找树。
特点：B树每个结点可以存放多个关键字，存放的关键字是从左到右排序的（对比BST每个结点只存放一条数据）。
B树的所有叶子结点都在同一层。
一个m叉的B树，对于非叶结点，儿子的数量是在[2,m]之间，且每个结点的关键字数量是在[celi(m/2)-1,m-1]之间。
相比与AVL-tree和RB-tree，B树每个结点可以存放多个索引，这样查找的次数会降低一些。更重要的一点，限制数据库效率的其实是磁盘的读写。 同时，磁盘数据存储是采用块形式的，根据计算机的局部性原理，每次读取数据是时，同一个磁盘块的数据可以一次读取出来。 那么我们把每一个结点大小设置成一个磁盘块大小，只需要一次IO操作就可以取出一整块。
 
B+树，是B树的一种升级版本。
B+树的每个非叶子结点不保存关键字记录的指针，使得非叶子结点所能保存的关键字数量大大增加。
B+树所有叶子结点保存所有关键字记录指针，数据查询的时候必须要到叶子结点，查询的时间稳定。
对于叶子结点，从左到右串联成一个有序的链表，查询大小区间的时候非常方便，同时数据紧密性高，缓存的命中率高。
要遍历B+树的时候只需要遍历叶子结点，有利于做全表扫描。

B树的优点是，查询数据如果离根结点近，检索速度会比B+树快。

3.红黑树

红黑树是一棵平衡二叉查找树，能够保证所有操作的最坏时间复杂度都是O(logn)。
特点：每个结点都有红或黑两种颜色。
     根结点是黑色的，每个叶子结点也是黑色的(叶子结点不保存数据)。
     如果一个结点是红色的，那么它的两个儿子都是黑色的。
     一个结点，到它子树里任意一个叶子的路径上经过的黑色结点数量都是相同的。

相比于AVL-tree，AVL的树高被严格控制，所以查找会很快，但是一旦修改了树的结构，就需要经过多次的旋转调整。
rb-tree采取了一种比较折中的方案，它采用非严格平衡来降低旋转的次数，一般不超过3次。

4.悲观锁和乐观锁

悲观锁：每次获得数据时都担心数据被修改，所以会对数据加锁，期间任何访问该数据的进程都会等待，直到使用完毕后释放。
乐观锁：每次获得数据时都不担心数据会被修改，所以不会对数据加锁。但是要修改数据时会判断在此期间是否有其它进程修改过。

悲观锁适用于写操作比较频繁的场景，乐观锁适用于读操作比较频繁的场景。

5.数据库的隔离级别

谈到隔离性，就需要先知道数据库事务，事务它是数据库管理系统执行过程的一个逻辑单位，由一系列的数据库操作序列构成。隔离指多个事务并发时，彼此之间应该互不影响。

事务的隔离级别根据并发程度从高到低有四种。
读未提交，一个事务修改了数据库以后即使没有提交，另一个事务访问数据库时，访问到的也是修改后的数据（脏读）
读提交，一个事务修改数据库以后并提交，另一个事务才能访问到修改过后的数据，否则读到的是修改之前的。 （Oracle和Sql Server的默认隔离级别，会产生不可重复读的问题）
可重复读，在同一个事务，select的结果是事务开始时间点的状态(MySql的默认隔离级别，会出现“幻读”)
序列化，所有事务都是串行的，数据会被加锁。

6.各种锁

7.索引种类
其实索引的分类有各种规则。

普通索引，没有任何限制规则。

唯一索引，创建索引的列可以有空值，但是不能有重复的值。唯一索引除了加快查询以外。在插入数据时会自动检查数据的唯一性。

主键索引，在建表的时候会自动创建，不能有空值。









