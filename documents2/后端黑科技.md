1.hash一致性
目前的很多服务都是做成分布式的，也就是一个数据表可能会被存储在多台服务器上。负载均衡的策略往往都是通过hash来实现的。
举个栗子，比如现在一个集群中有7台机器，当有一个请求打过来的时候，具体分发给哪台机器，我们通过hash来决定，假设把这个请求的key哈希之后得到的数字是8，8%7=1，所以我们会把这个请求分发给1号机器。这看起来没什么问题，但当集群扩容以后，增加到8台机器，之前的请求，8%8=0，我们应该把刚刚存储在1号机器上的数据转存到0号机器上。这样，因为模数的变化，实际上每次机器扩容以后所有的数据分布都需要变化，这样的开销是不能接受的。
所以需要引入另一种技术。我们可以假设我们有很多台机器，比如100台，实际上真正的机器编号我们假设是10，50，当哈希到一个不存在的机器编号上，比如9，我们就向前探测，直到找到一个真正存在的机器编号，这个栗子里是10，我们把请求分发给10号机器。当集群扩容的时候，容易发现只会影响到一台机器。此外，为了防止编号最大的机器下线，通常哈希空间会做成环状。这样最后一台机器的数据会分发给第一台机器。
这样的模型实际上是一个链表，为了加速查询，可以借助跳表的思路，提取索引，加速查询。

---

2.负载均衡
负载均衡是分布式服务里一个很重要的概念。
所谓负载均衡就是在客户端和服务端之前引入一个负载均衡器，负载均衡器把请求分发给正常运作的服务器。负载均衡器本质上也是一个服务器。它会维护一个健康运行的服务器列表，通过特定时间请求固定端口来维护这个列表，然后把请求分发给正常运行的服务器。
负载均衡算法，轮询，依次下发请求，比较平均；分发请求给最小连接的服务器；根据请求的ip的hash值来把请求分发给特定服务器，这样能保证特定用户请求总是由相同的服务器来响应。(sticky session也能做到相同的事情)
如何防止负载均衡器挂掉？很简单，多布置几台，主服务器挂掉就让follower继续服务。